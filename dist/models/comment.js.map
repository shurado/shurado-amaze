{"version":3,"sources":["../../src/models/comment.js"],"names":["module","exports","sequelize","DataTypes","comment","define","text","type","TEXT","validate","notEmpty","msg","status","ENUM","comment_type","defaultValue","scopes","active","where","$ne","associate","models","belongsTo","user","foreignKey","feed","prototype","serializeFields"],"mappings":"AAAA;;AAEAA,OAAOC,OAAP,GAAiB,UAASC,SAAT,EAAoBC,SAApB,EAA+B;AAC9C,MAAIC,UAAUF,UAAUG,MAAV,CAAiB,SAAjB,EAA4B;AACxCC,UAAM;AACJC,YAAMJ,UAAUK,IADZ;AAEJC,gBAAU;AACRC,kBAAU,EAAEC,KAAK,WAAP;AADF;AAFN,KADkC;AAOxCC,YAAQ;AACNL,YAAMJ,UAAUU,IAAV,CAAe,SAAf,EAA0B,QAA1B,EAAoC,WAApC;AADA,KAPgC;AAUxCC,kBAAc;AACZP,YAAMJ,UAAUU,IAAV,CAAe,SAAf,EAA0B,YAA1B,CADM;AAEZE,oBAAc;AAFF;AAV0B,GAA5B,EAcX;AACDC,YAAQ;AACNC,cAAQ;AACNC,eAAO,EAAEN,QAAQ,EAAEO,KAAK,SAAP,EAAV;AADD;AADF;AADP,GAdW,CAAd;;AAsBAf,UAAQgB,SAAR,GAAoB,UAASC,MAAT,EAAiB;AACnCjB,YAAQkB,SAAR,CAAkBD,OAAOE,IAAzB,EAA+B,EAAEC,YAAY,SAAd,EAA/B;AACApB,YAAQkB,SAAR,CAAkBD,OAAOI,IAAzB,EAA+B,EAAED,YAAY,SAAd,EAA/B;AACD,GAHD;;AAKApB,UAAQsB,SAAR,CAAkBC,eAAlB,GAAoC,CAAC,MAAD,EAAS,cAAT,EAAyB,WAAzB,EAAsC,WAAtC,EAAmD,MAAnD,CAApC;;AAEA,SAAOvB,OAAP;AACD,CA/BD","file":"comment.js","sourcesContent":["'use strict';\n\nmodule.exports = function(sequelize, DataTypes) {\n  var comment = sequelize.define('comment', {\n    text: {\n      type: DataTypes.TEXT,\n      validate: {\n        notEmpty: { msg: '留言內容不可為空白' },\n      }\n    },\n    status: {\n      type: DataTypes.ENUM('deleted', 'edited', 'published')\n    },\n    comment_type: {\n      type: DataTypes.ENUM('comment', 'suggestion'),\n      defaultValue: 'comment'\n    }\n  }, {\n    scopes: {\n      active: {\n        where: { status: { $ne: 'deleted' } }\n      }\n    }\n  });\n  \n  comment.associate = function(models) {\n    comment.belongsTo(models.user, { foreignKey: 'user_id' });\n    comment.belongsTo(models.feed, { foreignKey: 'feed_id' });\n  }\n\n  comment.prototype.serializeFields = ['text', 'comment_type', 'createdAt', 'updatedAt', 'user'];\n\n  return comment;\n};\n"]}