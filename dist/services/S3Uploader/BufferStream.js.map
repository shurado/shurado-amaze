{"version":3,"sources":["../../../src/services/S3Uploader/BufferStream.js"],"names":["require","Readable","inherits","BufferStream","source","Buffer","isBuffer","TypeError","_source","_offset","_length","length","on","_destroy","call","prototype","_read","size","push","slice","module","exports"],"mappings":";;eAAqBA,QAAQ,QAAR,C;IAAbC,Q,YAAAA,Q;;gBACaD,QAAQ,MAAR,C;IAAbE,Q,aAAAA,Q;;AAGR,SAASC,YAAT,CAAsBC,MAAtB,EAA8B;AAC5B,MAAI,CAACC,OAAOC,QAAP,CAAgBF,MAAhB,CAAL,EAA8B;AAC5B,UAAM,IAAIG,SAAJ,CAAc,0BAAd,CAAN;AACD;;AAED,OAAKC,OAAL,GAAeJ,MAAf;AACA,OAAKK,OAAL,GAAe,CAAf;AACA,OAAKC,OAAL,GAAeN,OAAOO,MAAtB;;AAEA,OAAKC,EAAL,CAAQ,KAAR,EAAe,KAAKC,QAApB;AACAZ,WAASa,IAAT,CAAc,IAAd;AACD;;AAEDZ,SAASC,YAAT,EAAuBF,QAAvB;;AAEAE,aAAaY,SAAb,CAAuBC,KAAvB,GAA+B,YAA4B;AAAA,MAAnBC,IAAmB,uEAAX,OAAO,CAAI;;;AAEzD,MAAI,KAAKR,OAAL,GAAe,KAAKC,OAAxB,EAAiC;AAC/B,SAAKQ,IAAL,CAAU,KAAKV,OAAL,CAAaW,KAAb,CAAmB,KAAKV,OAAxB,EAAiC,KAAKA,OAAL,GAAeQ,IAAhD,CAAV;AACA,SAAKR,OAAL,IAAgBQ,IAAhB;AACD;;AAGD,MAAI,KAAKR,OAAL,GAAe,KAAKC,OAAxB,EAAiC;AAC/B,SAAKQ,IAAL,CAAU,IAAV;AACD;AACF,CAXD;;AAaAf,aAAaY,SAAb,CAAuBF,QAAvB,GAAkC,YAAW;AAC3C,OAAKL,OAAL,GAAe,IAAf;AACA,OAAKC,OAAL,GAAe,IAAf;AACA,OAAKC,OAAL,GAAe,IAAf;AACD,CAJD;;AAMAU,OAAOC,OAAP,GAAiBlB,YAAjB","file":"BufferStream.js","sourcesContent":["const { Readable } = require('stream');\nconst { inherits } = require('util');\n\n\nfunction BufferStream(source) {\n  if (!Buffer.isBuffer(source)) {\n    throw new TypeError('source must be a Buffer!');\n  }\n\n  this._source = source;\n  this._offset = 0;\n  this._length = source.length;\n\n  this.on('end', this._destroy);\n  Readable.call(this);\n}\n\ninherits(BufferStream, Readable);\n\nBufferStream.prototype._read = function(size = (1024 * 5)) {\n  \n  if (this._offset < this._length) {\n    this.push(this._source.slice(this._offset, this._offset + size));\n    this._offset += size;\n  }\n\n\n  if (this._offset > this._length) {\n    this.push(null);\n  }\n}\n\nBufferStream.prototype._destroy = function() {\n  this._source = null;\n  this._offset = null;\n  this._length = null;\n}\n\nmodule.exports = BufferStream;\n"]}