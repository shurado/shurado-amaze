{"version":3,"sources":["../../src/middlewares/upload.js"],"names":["S3Uploader","require","BufferStream","upload","key","body","mimetype","bufferStream","uploader","accessKeyId","process","env","AWS_ACCESS_KEY_ID","secretAccessKey","AWS_SECRET_ACCESS_KEY","bucket","S3_BUCKET","region","module","exports"],"mappings":";;AAAA,IAAMA,aAAaC,QAAQ,wBAAR,CAAnB;AACA,IAAMC,eAAeD,QAAQ,qCAAR,CAArB;;AAEA,IAAME,SAAS,SAATA,MAAS,CAACC,GAAD,EAAMC,IAAN,EAAYC,QAAZ,EAAyB;AACtC,UAAQA,QAAR;AACE,SAAK,YAAL;AACEA,iBAAW,MAAX,CADF,CACqB;AACnB;AACF;AACEA,iBAAW,MAAX,CADF,CACqB;AACnB;AANJ;;AASA,MAAMC,eAAe,IAAIL,YAAJ,CAAiBG,IAAjB,CAArB;AACA,MAAMG,WAAW,IAAIR,UAAJ,CAAe;AAC9BS,iBAAaC,QAAQC,GAAR,CAAYC,iBADK;AAE9BC,qBAAiBH,QAAQC,GAAR,CAAYG,qBAFC;AAG9BC,YAAQL,QAAQC,GAAR,CAAYK,SAHU;AAI9BC,YAAQ;AAJsB,GAAf,CAAjB;;AAOAT,WAASL,MAAT,CAAgB,CAAC;AACfC,SAAKA,MAAME,QADI;AAEfD,UAAME;AAFS,GAAD,CAAhB;;AAKA,SAAOC,QAAP;AACD,CAxBD;;AA0BAU,OAAOC,OAAP,GAAiBhB,MAAjB","file":"upload.js","sourcesContent":["const S3Uploader = require('../services/S3Uploader');\nconst BufferStream = require('../services/S3Uploader/BufferStream');\n\nconst upload = (key, body, mimetype) => {\n  switch (mimetype) {\n    case 'image/jpeg':\n      mimetype = '.jpg'; // eslint-disable-line\n      break;\n    default:\n      mimetype = '.jpg'; // eslint-disable-line\n      break;\n  }\n\n  const bufferStream = new BufferStream(body);\n  const uploader = new S3Uploader({\n    accessKeyId: process.env.AWS_ACCESS_KEY_ID,\n    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY,\n    bucket: process.env.S3_BUCKET,\n    region: 'us-west-2'\n  });\n\n  uploader.upload([{\n    key: key + mimetype,\n    body: bufferStream\n  }]);\n\n  return uploader;\n};\n\nmodule.exports = upload;\n"]}